% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Molecule3D.R
\name{add_dummy_atom}
\alias{add_dummy_atom}
\title{Add a dummy atom defined by internal coordinates}
\usage{
add_dummy_atom(
  molecule,
  atom_id_a,
  atom_id_b,
  atom_id_c,
  bond_length,
  torsion_angle,
  bond_angle,
  bond_type = "1",
  elena = "Du"
)
}
\arguments{
\item{molecule}{A \code{Molecule3D} object.}

\item{atom_id_a, atom_id_b, atom_id_c}{Numeric atom IDs (matching \code{atoms$eleno})
that define the reference frame for the new atom D. The new atom is placed at
a distance \code{bond_length} from \code{atom_id_c}, with bond angle
\code{B<U+2013>C<U+2013>D = bond_angle} and torsion \code{A<U+2013>B<U+2013>C<U+2013>D = torsion_angle}.}

\item{bond_length}{Numeric scalar; distance (<U+00C5>) from atom C to the new atom D.}

\item{torsion_angle}{Numeric scalar; dihedral angle \code{A<U+2013>B<U+2013>C<U+2013>D} in degrees.}

\item{bond_angle}{Numeric scalar; bond angle \code{B<U+2013>C<U+2013>D} in degrees.}

\item{bond_type}{Character scalar specifying the SYBYL/Tripos bond code for the
new C<U+2013>D bond (e.g., \code{"1"}, \code{"2"}, \code{"ar"}, \code{"un"}). Defaults to \code{"1"}.}

\item{elena}{Character scalar atom label for the dummy atom (default \code{"Du"}).}
}
\value{
A \code{Molecule3D} object containing the appended dummy atom and its bond to C.
}
\description{
Inserts a <U+201C>dummy<U+201D> atom (default element label \code{"Du"}) into a
\code{Molecule3D} using three reference atoms and internal coordinates:
bond length to atom C, bond angle at B<U+2013>C<U+2013>D, and torsion A<U+2013>B<U+2013>C<U+2013>D. The new
atom is appended to the \code{@atoms} table and connected by a single bond
to atom C (via \code{\link{add_bonds}}). Identifiers are assigned using
\code{molecule@maximum_atom_id + 1}.
}
\details{
Geometry is computed with \pkg{compas} (\code{compas::calCo()}), with angles
interpreted in degrees.

The function:
\itemize{
\item Retrieves the Cartesian coordinates of atoms A, B, C via
\code{\link{fetch_atom_position}}.
\item Calls \code{compas::calCo()} to compute the D coordinates from
\code{bond_length}, \code{bond_angle}, and \code{torsion_angle}
(angles in degrees).
\item Creates a one-row atoms table for D (\code{eleno = maximum\_atom\_id + 1},
\code{elena = elena}, and computed \code{x,y,z}), then merges it into
the input molecule via \code{\link{combine_molecules}} (with
\code{update_ids = FALSE}).
\item Adds a single bond between C (\code{atom_id_c}) and D using
\code{\link{add_bonds}} with the supplied \code{bond_type}.
}

The molecule<U+2019>s \code{@anchor} and other properties are preserved.
}
\examples{
m <- read_mol2(system.file("benzene.mol2", package = "structures"))

# Suppose atoms 1-2-3 exist and define a sensible frame.
m2 <- add_dummy_atom(
  molecule = m,
  atom_id_a = 1, atom_id_b = 2, atom_id_c = 3,
  bond_length = 1.5,
  torsion_angle = 60,
  bond_angle = 109.5,
  bond_type = "1",
  elena = "Du"
)
tail(m2@atoms)
tail(m2@bonds)

}
\seealso{
\code{\link{add_bonds}}, \code{\link{combine_molecules}},
\code{\link{fetch_atom_position}}, \code{\link{Molecule3D}}
}
