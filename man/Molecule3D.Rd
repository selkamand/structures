% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Molecule3D.R
\name{Molecule3D}
\alias{Molecule3D}
\title{Create a Molecule3D object}
\usage{
Molecule3D(
  name = "MyChemical",
  atoms = minimal_atoms(),
  bonds = minimal_bonds(),
  symmetry_elements = SymmetryElementCollection(),
  misc = list(),
  anchor = NULL
)
}
\arguments{
\item{name}{Character scalar. Molecule name.}

\item{atoms}{Data frame describing atoms in the molecule.
\strong{Essential columns} (must be present on input):
\itemize{
\item \code{eleno} (numeric) atom ID (unique per atom)
\item \code{elena} (character) element label or atom name
\item \code{x}, \code{y}, \code{z} (numeric) Cartesian coordinates
}
\strong{Optional columns} (automatically added if not supplied):
\itemize{
\item \code{element} (character) element symbol; if missing, it is derived from
\code{elena} by removing digits (e.g., \code{"C3"} <U+2192> \code{"C"}).
\item \code{atom_type} valid SYBYL atom types. See \code{\link[=valid_atom_types]{valid_atom_types()}} for valid values. If not supplied will automatically be set to 'Any'.
}
Data types are enforced so that \code{eleno}, \code{elena}, and \code{element}
are character, and \code{x}, \code{y}, \code{z} are numeric.
When accessed as \code{molecule@atoms}, the data frame always includes all
essential columns plus \code{element}.}

\item{bonds}{Data frame describing bonds between atoms.
\strong{Essential columns}:
\itemize{
\item \code{bond_id} (numeric) unique bond identifier
\item \code{origin_atom_id}, \code{target_atom_id} (numeric) atom IDs
that correspond to \code{atoms$eleno}
}
\strong{Optional columns}:
\itemize{
\item \code{bond_type} (character) SYBYL/Tripos bond code (e.g. "1", "2", "ar");
if missing, it is added with the value \code{"un"} (unknown).
}
All other columns are retained as-is.}

\item{symmetry_elements}{A \code{\link{SymmetryElementCollection}} object describing a set of symmetry axes
embedded in the molecule}

\item{misc}{A list containing any additional metadata (e.g., provenance,
notes, or debug information). Stored without modification.}

\item{anchor}{Numeric length-3 vector c(x, y, z) specifying the molecule<U+2019>s
reference point. If NULL (default), it is set to the geometric center of
all atoms at construction time; if no atoms are present it falls back to
c(0, 0, 0). Used by translation helpers
(e.g., \code{\link{translate_molecule_to_origin}}, \code{\link{translate_molecule_to_position}},
\code{\link{translate_molecule_by_vector}}) to reposition the molecule relative
to this point. Typically set to an atom<U+2019>s coordinates via
\code{\link{set_anchor_by_atom}} or to an arbitrary position via
\code{\link{set_anchor_by_position}}.}
}
\value{
An S7 object of class \code{"Molecule3D"} with (among others) the properties:
\itemize{
\item \strong{name}, \strong{atoms}, \strong{bonds}, \strong{misc}, \strong{anchor}
\item \strong{atom_ids}, \strong{bond_ids}, \strong{maximum_atom_id}, \strong{maximum_bond_id}
\item \strong{atom_positions}, \strong{bond_positions}, \strong{bond_positions_interleaved}
\item \strong{center}
\item \strong{symmetry_elements} A \code{\link{SymmetryElementCollection}} object describing the symmetry axes of this molecule.
\item \strong{contains_symmetry_elements} logical (read-only)
}
}
\description{
Constructs an S7 object representing a single molecule with 3D coordinates.
In most workflows, you will not call this constructor directly molecule
objects are usually created by parsers such as \code{\link[=read_mol2]{read_mol2()}}.
}
\details{
During creation, \code{atoms} and \code{bonds} are processed using internal
helpers (\code{format_atoms()} and \code{format_bonds()}) to ensure
required columns are present, types are correct, and that all bond endpoints
refer to valid atoms. If \code{symmetry_elements} is supplied, it is validated
to be a \code{\link{SymmetryElementCollection}}. The class also exposes derived,
read-only properties related to symmetry:
\itemize{
\item \code{@contains_symmetry_axes} logical flag indicating whether any symmetry elements have been added to this molecule.
}
Coordinate transforms applied via \code{\link{transform_molecule}} will also
transform the endpoints of each stored symmetry axis so they remain consistent
with atom coordinates.
}
\section{Anchor}{

The \emph{anchor} is a persistent reference position stored as a length-3 numeric
vector (\code{c(x, y, z)}). It does not constrain geometry by itself; instead it
supports convenient re-positioning:
\itemize{
\item \code{\link{set_anchor_by_position}} <U+2014> set the anchor to an arbitrary position.
\item \code{\link{set_anchor_by_atom}} <U+2014> set the anchor to the coordinates of a given atom (\code{eleno}).
\item \code{\link{translate_molecule_to_origin}} <U+2014> translate so the anchor moves to \code{c(0,0,0)}.
\item \code{\link{translate_molecule_to_position}} <U+2014> translate so the anchor moves to a specified position.
\item \code{\link{translate_molecule_by_vector}} <U+2014> translate by a specified vector.
}
Functions that transform coordinates (e.g., \code{transform_molecule()}) also
update the anchor to keep it consistent with the new coordinate frame.
}

\examples{
# Read mol2 file into a Molecule3D object
benzene <- read_mol2(system.file("benzene.mol2", package = "structures"))
print(benzene)

# Directly create Molecule3D
# object from atoms and bonds data.frames
atoms <- data.frame(
  eleno = c(1, 2),
  elena = c("C", "O"),
  x = c(0, 1.2), y = c(0, 0.1), z = c(0, -0.2)
)
bonds <- data.frame(
  bond_id = 1,
  origin_atom_id = 1,
  target_atom_id = 2
)

m <- Molecule3D(
  name = "CO", atoms = atoms, bonds = bonds,
  anchor = c(0, 0, 0)
)

# Add a proper rotation axis
proper_rotation_axis <- ProperRotationAxis(
  n = 3L,
  posA = c(0, 0, 0),
  posB = c(0, 0, 1),
  label = "C3(z)"
)
m <- add_symmetry_element_to_molecule(m, proper_rotation_axis)
print(m)

}
\seealso{
\code{\link[=read_mol2]{read_mol2()}},
\link{ProperRotationAxis},
\code{\link[=add_symmetry_element_to_molecule]{add_symmetry_element_to_molecule()}},
\code{\link[=transform_molecule]{transform_molecule()}}
}
