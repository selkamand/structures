% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Molecule3D.R
\name{Molecule3D}
\alias{Molecule3D}
\title{Create a Molecule3D object}
\usage{
Molecule3D(
  name = "MyChemical",
  atoms = minimal_atoms(),
  bonds = minimal_bonds(),
  symmetry_elements = SymmetryElements(),
  symmetry_axes = list(),
  misc = list(),
  anchor = NULL
)
}
\arguments{
\item{name}{Character scalar. Molecule name.}

\item{atoms}{Data frame describing atoms in the molecule.
\strong{Essential columns} (must be present on input):
\itemize{
\item \code{eleno} (numeric) atom ID (unique per atom)
\item \code{elena} (character) element label or atom name
\item \code{x}, \code{y}, \code{z} (numeric) Cartesian coordinates
}
\strong{Optional columns} (automatically added if not supplied):
\itemize{
\item \code{element} (character) element symbol; if missing, it is derived from
\code{elena} by removing digits (e.g., \code{"C3"} → \code{"C"}).
}
Data types are enforced so that \code{eleno}, \code{elena}, and \code{element}
are character, and \code{x}, \code{y}, \code{z} are numeric.
When accessed as \code{molecule@atoms}, the data frame always includes all
essential columns plus \code{element}.}

\item{bonds}{Data frame describing bonds between atoms.
\strong{Essential columns}:
\itemize{
\item \code{bond_id} (numeric) unique bond identifier
\item \code{origin_atom_id}, \code{target_atom_id} (numeric) atom IDs
that correspond to \code{atoms$eleno}
}
\strong{Optional columns}:
\itemize{
\item \code{bond_type} (character) SYBYL/Tripos bond code (e.g. "1", "2", "ar");
if missing, it is added with the value \code{"un"} (unknown).
}
All other columns are retained as-is.}

\item{symmetry_axes}{List of zero or more \code{\link{ProperRotationAxis}} objects
describing proper rotation axes embedded in the molecule. Each element must
satisfy \code{\link[=is_symmetry_axis]{is_symmetry_axis()}}. An empty list is valid and indicates that no
symmetry axes have been annotated yet.}

\item{misc}{A list containing any additional metadata (e.g., provenance,
notes, or debug information). Stored without modification.}

\item{anchor}{Numeric length-3 vector c(x, y, z) specifying the molecule’s
reference point. If NULL (default), it is set to the geometric center of
all atoms at construction time; if no atoms are present it falls back to
c(0, 0, 0). Used by translation helpers
(e.g., \code{\link{translate_molecule_to_origin}}, \code{\link{translate_molecule_to_position}},
\code{\link{translate_molecule_by_vector}}) to reposition the molecule relative
to this point. Typically set to an atom’s coordinates via
\code{\link{set_anchor_by_atom}} or to an arbitrary position via
\code{\link{set_anchor_by_position}}.}
}
\value{
An S7 object of class \code{"Molecule3D"} with (among others) the properties:
\itemize{
\item \strong{name}, \strong{atoms}, \strong{bonds}, \strong{misc}, \strong{anchor}
\item \strong{atom_ids}, \strong{bond_ids}, \strong{maximum_atom_id}, \strong{maximum_bond_id}
\item \strong{atom_positions}, \strong{bond_positions}, \strong{bond_positions_interleaved}
\item \strong{center}
\item \strong{symmetry_axes} — list of \code{\link{ProperRotationAxis}} objects
\item \strong{symmetry_axes_orders} — numeric vector of unique \code{Cn} values (read-only)
\item \strong{contains_symmetry_axes} — logical (read-only)
\item \strong{symmetry_axes_dataframe} — data frame (read-only) with one row per
symmetry axis. Columns: \code{id} (character; the axis ID = list name),
\code{label} (character), \code{Cn} (integer-like), \code{x,y,z} (numeric; start
point), \code{xend,yend,zend} (numeric; end point). Returns a zero-row data frame
with the same columns when no axes are present.
}
}
\description{
Constructs an S7 object representing a single molecule with 3D coordinates.
In most workflows, you will not call this constructor directly — molecule
objects are usually created by parsers such as \code{\link[=read_mol2]{read_mol2()}}.
}
\details{
During creation, \code{atoms} and \code{bonds} are processed using internal
helpers (\code{format_atoms()} and \code{format_bonds()}) to ensure
required columns are present, types are correct, and that all bond endpoints
refer to valid atoms. If \code{symmetry_axes} is supplied, each element is
validated to be a \code{\link{ProperRotationAxis}}. The class also exposes derived,
read-only properties related to symmetry:
\itemize{
\item \code{@symmetry_axes_orders} — unique set of \code{Cn} values present.
\item \code{@contains_symmetry_axes} — logical flag indicating whether any axes exist.
}
Coordinate transforms applied via \code{\link{transform_molecule}} will also
transform the endpoints of each stored symmetry axis so they remain consistent
with atom coordinates (the axis order \code{Cn} is preserved).
}
\section{Anchor}{

The \emph{anchor} is a persistent reference position stored as a length-3 numeric
vector (\code{c(x, y, z)}). It does not constrain geometry by itself; instead it
supports convenient re-positioning:
\itemize{
\item \code{\link{set_anchor_by_position}} — set the anchor to an arbitrary position.
\item \code{\link{set_anchor_by_atom}} — set the anchor to the coordinates of a given atom (\code{eleno}).
\item \code{\link{translate_molecule_to_origin}} — translate so the anchor moves to \code{c(0,0,0)}.
\item \code{\link{translate_molecule_to_position}} — translate so the anchor moves to a specified position.
\item \code{\link{translate_molecule_by_vector}} — translate by a specified vector.
}
Functions that transform coordinates (e.g., \code{transform_molecule()}) also
update the anchor to keep it consistent with the new coordinate frame.
}

\examples{
# Typical use via parser
# mol <- structures::read_mol2("benzene.mol2")

# Direct creation, symmetry axes, and anchor operations
atoms <- data.frame(
  eleno = c(1, 2),
  elena = c("C","O"),
  x = c(0, 1.2), y = c(0, 0.1), z = c(0, -0.2)
)
bonds <- data.frame(
  bond_id = 1,
  origin_atom_id = 1,
  target_atom_id = 2
)
ax  <- ProperRotationAxis(Cn = 3L, posA = c(0,0,0), posB = c(0,0,1))
m <- Molecule3D(name = "CO", atoms = atoms, bonds = bonds,
                symmetry_axes = list(ax), anchor = c(0,0,0))
m@symmetry_axes_orders
m@contains_symmetry_axes
m@symmetry_axes_dataframe

}
\seealso{
\code{\link[=read_mol2]{read_mol2()}},
\link{ProperRotationAxis}, \code{\link[=is_symmetry_axis]{is_symmetry_axis()}},
\code{\link[=add_proper_rotation_axis]{add_proper_rotation_axis()}}, \code{\link[=fetch_all_proper_rotation_axes_with_order]{fetch_all_proper_rotation_axes_with_order()}},
\code{\link[=transform_molecule]{transform_molecule()}}, \code{\link[=transform_symmetry_axis]{transform_symmetry_axis()}}
}
