% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/1-SymmetryElements.R
\name{ImproperRotationAxis}
\alias{ImproperRotationAxis}
\title{ImproperRotationAxis: improper rotational symmetry axis (S_n)}
\usage{
ImproperRotationAxis(
  n,
  posA,
  plane_point = posA,
  posB = NULL,
  direction = NULL,
  L = NULL,
  label = "unnamed"
)
}
\arguments{
\item{n}{Numeric scalar. Axis fold/order (whole number >= 1).}

\item{posA}{Numeric length-3 vector giving a point on the axis (\code{c(x, y, z)}).}

\item{plane_point}{Numeric length-3 vector giving a point in the mirror
plane. The plane normal is taken to be the axis direction. By default this
is \code{posA}, i.e. the plane cuts the axis at \code{posA}.}

\item{posB}{Optional numeric length-3 vector giving a second point on the axis.
Mutually exclusive with \code{direction}. When supplied, \code{direction} and \code{L} are
inferred from \code{posA} and \code{posB}.}

\item{direction}{Optional numeric length-3 vector giving the axis direction.
Normalised on set. Mutually exclusive with \code{posB}. If used without \code{L},
\code{L} defaults to 1.}

\item{L}{Numeric scalar. Positive distance between \code{posA} and \code{posB}. If
\code{direction} is supplied and \code{L} is omitted, \code{L} defaults to 1.}

\item{label}{Character scalar. Optional user-defined name or description
for the symmetry element.}
}
\value{
An S7 object of class \code{ImproperRotationAxis}.
}
\description{
Represents an improper rotation axis (S\eqn{_n}) in 3D, combining a proper
rotation (C\eqn{_n}) about the axis with reflection in a plane perpendicular
to that axis. Geometrically, the axis is described exactly as in
\code{\link[=ProperRotationAxis]{ProperRotationAxis()}} (via \code{n}, \code{posA}, \code{direction}, \code{L}), with an
additional point \code{plane_point} that fixes the location of the mirror plane.
}
\details{
The mirror plane is defined as the set of points \code{x} satisfying
\verb{(x - plane_point) Â· direction = 0}, i.e. a plane with normal equal to
the axis direction, passing through \code{plane_point}. In typical molecular
symmetry, \code{plane_point} will also lie on the axis (e.g. at \code{posA}).
}
\examples{
# S4 axis along +Z through the origin; mirror plane perpendicular to the axis
# and cutting it at the origin (plane_point = posA).
iax1 <- ImproperRotationAxis(
  n          = 4L,
  posA        = c(0, 0, 0),
  posB        = c(0, 0, 1),
  plane_point = c(0, 0, 0),
  label       = "S4(z)"
)

iax1@type   # "Improper Rotation Axis"

# S6 axis along +Z, with the mirror plane shifted along the axis
iax2 <- ImproperRotationAxis(
  n          = 6L,
  posA        = c(0, 0, 0),
  direction   = c(0, 0, 1),
  L           = 2,
  plane_point = c(0, 0, 0.5),
  label       = "S6(z)"
)

}
