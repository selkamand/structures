% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Molecule3D.R
\name{rotate_molecule_so_rotation_axis_aligns_with_vector}
\alias{rotate_molecule_so_rotation_axis_aligns_with_vector}
\title{Rotate a molecule so that a symmetry axis aligns with a target vector}
\usage{
rotate_molecule_so_rotation_axis_aligns_with_vector(
  molecule,
  symmetry_element_id,
  target
)
}
\arguments{
\item{molecule}{A \code{\link{Molecule3D}} object.}

\item{symmetry_element_id}{Character ID of the symmetry element to align.
Must exist in \code{molecule@symmetry_elements}.}

\item{target}{Numeric length-3 vector giving the desired direction in space.}
}
\value{
A \code{\link{Molecule3D}} object rotated so that the selected symmetry
element’s direction matches \code{target}.
}
\description{
Rotates an entire \code{\link{Molecule3D}} object so that the direction of
a stored symmetry element (typically a \code{\link{ProperRotationAxis}})
aligns with a user-supplied 3D target vector.
}
\details{
This is achieved by:
\enumerate{
\item Extracting the symmetry element specified by \code{symmetry_element_id}.
\item Computing the rotation (axis + angle) required to align the element’s
direction vector to \code{target}, using
\code{\link[move:rotate_vector_to_align_with_target]{move::rotate_vector_to_align_with_target()}}.
\item Applying the resulting rotation to the entire molecule via
\code{\link[=rotate_molecule_around_vector]{rotate_molecule_around_vector()}}, including atoms, the anchor, and
all symmetry elements.
}

This helper is useful when a molecule has annotated symmetry elements and
needs to be re-oriented so one of its symmetry axes matches a desired global
direction (e.g., align a C\eqn{_n} axis with the z-axis).

The symmetry element’s direction is taken from its internal \verb{@direction}
vector, which is automatically normalised.
The \strong{target vector} does not need to be unit length.

The rotation behaviour (parallel, anti-parallel, numerical tolerance, etc.)
follows the rules in \code{\link[move:rotate_vector_to_align_with_target]{move::rotate_vector_to_align_with_target()}}.
}
\examples{
m <- read_mol2(system.file("benzene.mol2", package = "structures"))

# Add a C6 axis (id assigned automatically)
m <- add_symmetry_element_to_molecule(
  m,
  ProperRotationAxis(n = 6, posA = c(0,0,-1), posB = c(0,0,1))
)

# Get the axis ID
ax_id <- m@symmetry_elements@summary$ids[1]

# Align it with the global x-axis
m2 <- rotate_molecule_so_rotation_axis_aligns_with_vector(
  molecule = m,
  symmetry_element_id = ax_id,
  target = c(1, 0, 0)
)

}
\seealso{
\code{\link[move:rotate_vector_to_align_with_target]{move::rotate_vector_to_align_with_target()}},
\code{\link[=rotate_molecule_around_vector]{rotate_molecule_around_vector()}},
\code{\link[=fetch_symmetry_element_from_molecule]{fetch_symmetry_element_from_molecule()}}
}
