% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Molecule3D.R
\name{fetch_eleno_downstream_of_bond}
\alias{fetch_eleno_downstream_of_bond}
\title{Fetch all atoms on one side of a bond}
\usage{
fetch_eleno_downstream_of_bond(molecule, bond_id, direction_atom_id)
}
\arguments{
\item{molecule}{A \code{Molecule3D} object.}

\item{bond_id}{Numeric bond identifier (must exist in \code{molecule@bond_ids}).}

\item{direction_atom_id}{Numeric atom ID (\code{eleno}) that is one endpoint of
\code{bond_id}. The returned cluster is the connected component containing
this atom after the opposite endpoint is removed.}
}
\value{
A numeric vector of atom IDs (\code{eleno}) forming the downstream
connected component that includes \code{direction_atom_id}.
}
\description{
Given a bond ID and a "direction" atom on that bond, returns the set of atom
IDs (\code{eleno}) that remain connected to the \emph{direction} atom after
virtually breaking the bond (i.e., removing the other endpoint atom). This is
useful for identifying the substructure that would rotate or translate when
treating the chosen bond as a rotatable hinge.
}
\details{
The algorithm:
\enumerate{
\item Validates that \code{bond_id} exists and locates its two endpoint atom IDs.
\item Checks that \code{direction_atom_id} is one of the endpoints; otherwise
an error is thrown.
\item Removes the \emph{other} endpoint atom from the molecule via
\code{\link{remove_atoms}} (this simulates breaking the bond).
\item Uses the molecule's \code{@connectivity} property (list of connected
components, as numeric \code{eleno} vectors) to select the component
that contains \code{direction_atom_id}.
}

If no disconnection occurs (i.e., only one connected component remains),
the function errors with \code{"All points remain connected."}
}
\note{
The \code{@connectivity} property relies on \pkg{igraph} (via an
internal conversion to an igraph and \code{igraph::components()}).
}
\examples{
m <- read_mol2(system.file("fe_tripod.mol2", package = "structures"))
# Suppose bond 4 connects atoms 10 and 12, and we want the side attached to atom 10:
ids <- fetch_eleno_downstream_of_bond(molecule = m, bond_id = 16, direction_atom_id = 20)
ids

}
\seealso{
\code{\link{remove_atoms}}, \code{\link{compute_distance_between_atoms}}
}
