% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Class.R
\name{add_bonds}
\alias{add_bonds}
\title{Add one or more bonds to a Molecule3D object}
\usage{
add_bonds(molecule, origin_atom_id, target_atom_ids, bond_type = "un")
}
\arguments{
\item{molecule}{A \code{Molecule3D} object.}

\item{origin_atom_id}{Numeric atom ID (matching \code{atoms$eleno}) that serves
as the origin of the bond(s).}

\item{target_atom_ids}{One or more \strong{numeric} atom IDs (each matching
\code{atoms$eleno}) to connect to \code{origin_atom_id}.}

\item{bond_type}{Character scalar specifying the bond type code
(e.g., \code{"1"}, \code{"2"}, \code{"ar"}, \code{"am"}, \code{"un"}). Defaults to \code{"un"}.}
}
\value{
A \code{Molecule3D} object with additional rows in \code{@bonds}.
}
\description{
Appends one or more new bond records to a \code{Molecule3D} object. Each bond
connects a specified origin atom (\code{origin_atom_id}) to one or more
target atoms (\code{target_atom_ids}). Bond IDs are automatically assigned by
incrementing from the molecule’s current \code{@maximum_bond_id}.
}
\details{
This function extends the molecule’s \code{@bonds} table. It creates sequential
numeric \code{bond_id}s starting from \code{molecule@maximum_bond_id + 1}.
If multiple targets are supplied, one bond row is added per target.

The function validates that all supplied atom IDs exist in \code{molecule@atoms$eleno}.
The anchor and other properties are preserved.
}
\examples{
atoms <- data.frame(
  eleno = c(1, 2, 3),
  elena = c("C", "O", "H"),
  x = c(0, 1.2, -0.8),
  y = c(0, 0, 0.5),
  z = c(0, 0, 0)
)
bonds <- data.frame(
  bond_id = 1,
  origin_atom_id = 1,
  target_atom_id = 2,
  bond_type = "1"
)
m <- Molecule3D(name = "COH", atoms = atoms, bonds = bonds)
m <- add_bonds(m, origin_atom_id = 1, target_atom_ids = c(3), bond_type = "1")
m@bonds

}
\seealso{
\code{\link[=valid_bond_types]{valid_bond_types()}}, \code{\link[=combine_molecules]{combine_molecules()}}
}
