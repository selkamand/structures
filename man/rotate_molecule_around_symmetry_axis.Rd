% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Molecule3D.R
\name{rotate_molecule_around_symmetry_axis}
\alias{rotate_molecule_around_symmetry_axis}
\title{Rotate a molecule around a stored symmetry axis}
\usage{
rotate_molecule_around_symmetry_axis(
  molecule,
  symmetry_element_id,
  angle,
  careful = TRUE
)
}
\arguments{
\item{molecule}{A \code{\link{Molecule3D}} object to rotate.}

\item{symmetry_element_id}{Character ID of the symmetry element to use as the
rotation axis. This must correspond to an element in
\code{molecule@symmetry_elements}.}

\item{angle}{Numeric scalar giving the rotation angle in radians.
Positive angles follow the right-hand rule about the symmetry axis
direction (\code{sym_element@direction}).}

\item{careful}{Logical; if \code{TRUE} (default), performs basic input checks
(e.g. that \code{molecule} is a \code{Molecule3D}). Set to \code{FALSE} to skip checks
in performance-critical code.}
}
\value{
A \code{\link{Molecule3D}} object with all coordinates, the anchor,
and any symmetry elements rotated about the chosen symmetry axis by
\code{angle} radians.
}
\description{
Rotates all atoms in a \code{\link{Molecule3D}} object about one of its
stored symmetry elements (typically a \code{\link{ProperRotationAxis}})
by a specified angle, using the axis direction and a point on the axis
as the rotation line.
}
\details{
Internally, this is a convenience wrapper around
\code{\link[=rotate_molecule_around_vector]{rotate_molecule_around_vector()}}, which in turn delegates to
\code{move::rotate_vector_around_axis_through_point()} to apply a
Rodrigues-style rotation to each atomic coordinate.

The symmetry axis is defined by a direction vector (\verb{@direction}) and a point
on the axis (\verb{@posA}). This function:
\enumerate{
\item Retrieves the symmetry element via
\code{\link[=fetch_symmetry_element_from_molecule]{fetch_symmetry_element_from_molecule()}}.
\item Uses its \verb{@direction} and \verb{@posA} as the rotation axis and point.
\item Calls \code{\link[=rotate_molecule_around_vector]{rotate_molecule_around_vector()}} with the supplied \code{angle}
to rotate the entire molecule.
}

This is particularly useful for applying rotations that respect the molecule's
annotated point-group symmetry (e.g. performing a C\eqn{_n} rotation).
}
\examples{
m <- read_mol2(system.file("benzene.mol2", package = "structures"))

# Add a C6 axis along z (ID assigned automatically)
m <- add_symmetry_element_to_molecule(
  m,
  ProperRotationAxis(
    n    = 6L,
    posA = c(0, 0, -1),
    posB = c(0, 0,  1),
    label = "C6(z)"
  )
)

# Fetch the ID of the first symmetry element
ax_id <- m@symmetry_elements@summary$ids[1]

# Rotate the molecule by 60 degrees (2*pi/6) about that axis
m_rot <- rotate_molecule_around_symmetry_axis(
  molecule           = m,
  symmetry_element_id = ax_id,
  angle              = 2 * pi / 6
)

}
\seealso{
\code{\link[=rotate_molecule_around_vector]{rotate_molecule_around_vector()}},
\code{\link[=fetch_symmetry_element_from_molecule]{fetch_symmetry_element_from_molecule()}},
\code{move::rotate_vector_around_axis()},
\code{move::rotate_vector_around_axis_through_point()}
}
