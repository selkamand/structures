---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# structures <img src="man/figures/logo.png" align="right" height="124" alt="" />

<!-- badges: start -->
<!-- badges: end -->

An R package for working with 3D molecular structures in R.  
It provides the **`Molecule3D`** class for representing molecular geometry, 
together with parsers for the `.mol2` file format and a growing set of 
geometric manipulation tools.

---

## Installation

You can install the development version of **structures** like so:

```r
if (!require("remotes"))
  install.packages("remotes")

remotes::install_github("selkamand/structures")
```

---

## Quick Start

```{r}
library(structures)

# Read a mol2 file into a Molecule3D object
path <- system.file(package="structures", "benzene.mol2")
molecule <- read_mol2(path)

print(molecule)

# Set anchor to the first element and translate the molecule so that
# the anchor atom is at the origin (0, 0, 0)
molecule_centered <- molecule |>
  set_anchor_by_atom(eleno = 1) |>
  translate_molecule_to_origin()
```

---

## Symmetry Axes

The `structures` package now supports defining and storing **rotational symmetry axes** 
within a `Molecule3D` object.

### The `ProperRotationAxis` class

A **`ProperRotationAxis`** object represents a proper rotation axis (Câ‚™) defined by:
- `Cn`: the fold/order of the axis (e.g., 2, 3, 4, ...),
- `posA` and `posB`: two points in 3D space (`c(x, y, z)`) defining the axis line.

```{r}
# Create a simple C3 symmetry axis through the Z axis
axis_C3 <- ProperRotationAxis(Cn = 3L, posA = c(0, 0, 0), posB = c(0, 0, 1))
print(axis_C3)
```

### Adding Symmetry Elements

Symmetry elemnts can be attached to any `Molecule3D` object using helper functions:
[`add_proper_rotation_axis()`]:

```{r}
# Add a symmetry axis to the benzene molecule
molecule <- add_proper_rotation_axis(
  molecule,
  ProperRotationAxis(Cn = 6L, posA = c(0, 0, -1), posB = c(0, 0, 1))
)

# Inspect updated molecule summary
print(molecule)
```

The molecule keeps track of:
- all attached symmetry axes (`@symmetry_axes`),
- unique orders present (`@symmetry_axes_orders`),
- and whether any symmetry axes exist (`@contains_symmetry_axes`).

You can also retrieve all axes of a given order:

```{r}
fetch_all_proper_rotation_axes_with_order(molecule, Cn = 6L)
```

---

## Features Summary

- ðŸ§¬ `Molecule3D`: robust container for atomic and bonding data  
- ðŸ“‚ `.mol2` parser (`read_mol2()`)  
- âš™ï¸ Coordinate manipulation (`translate_molecule_*`, `transform_molecule()`)  
- ðŸ§­ Persistent anchors for positioning molecules  
- ðŸ” **New:** Rotational symmetry support via `ProperRotationAxis` and `add_symmetry_axis()`  
- ðŸ§© Connectivity and geometric utilities (`fetch_eleno_*`, `compute_distance_between_atoms()`)

---

## Citation

If you use **structures** in research or publications, please cite the package using:

```{r warning=FALSE}
citation("structures")
```
